{
  "kind": "spec_vs_diff_report",
  "version": "1.0",
  "generatedAt": "2026-02-14T04:35:33.396Z",
  "summary": "Frontend adds an admin-gated dashboard route (/admin) with user list fetching, search/filter, and block/unblock actions, plus admin-only navigation entry logic. Backend diff shows new types and in-memory maps for user access info, but the provided backend snippet does not show the required admin/user APIs nor enforcement of blocked users across protected update entrypoints.",
  "missing_requirements": [
    {
      "id": "REQ-22",
      "requirement": "Backend admin-only query to list user summaries including principal, optional profile, subscription status, and blocked flag; must deny non-admin callers; inclusion rules documented and consistent.",
      "reason": "Frontend calls `actor.getAllUserAccessInfo()`, but the backend diff excerpt only shows type definitions (`UserAccessInfo`) and a `userAccess` map; no `getAllUserAccessInfo` admin-only query implementation or access check is visible in the shown backend changes.",
      "evidence": [
        "frontend/src/hooks/useAdmin.ts",
        "backend/main.mo"
      ]
    },
    {
      "id": "REQ-23",
      "requirement": "Backend admin-only actions to block/unblock a target principal, and a query for any authenticated user to read their own blocked status.",
      "reason": "Frontend calls `actor.blockUser(...)` and `actor.unblockUser(...)`, and checks admin via `actor.isCallerAdmin()`, but the backend diff excerpt does not show implementations for `blockUser`, `unblockUser`, `isCallerAdmin`, or a caller-accessible 'my blocked status' query returning a boolean/equivalent.",
      "evidence": [
        "frontend/src/hooks/useAdmin.ts",
        "frontend/src/hooks/useIsAdmin.ts",
        "backend/main.mo"
      ]
    },
    {
      "id": "REQ-24",
      "requirement": "Enforce admin block override across protected backend update calls (evidence creation, work sessions start/end/sample logging, loss profile set, appeal generation, collective report submission, subscription upgrade) so blocked users are denied and no state is written.",
      "reason": "The backend diff excerpt does not show any authorization checks tied to `isBlockedByAdmin` being applied to protected update entrypoints, nor clear trap/deny messages for blocked users.",
      "evidence": [
        "backend/main.mo"
      ]
    }
  ],
  "hallucinated_features": [
    {
      "description": "Admin dashboard shows extra aggregated stats (total/blocked/active/expired) in addition to the requested table and controls.",
      "reason": "The BuildRequest did not ask for summary statistics; this is additional UI behavior beyond the stated AC.",
      "evidence": [
        "frontend/src/pages/AdminDashboardPage.tsx"
      ]
    }
  ],
  "confidence": 0.62,
  "changed_files": [
    "backend/main.mo",
    "frontend-file-summaries.txt",
    "frontend/src/App.tsx",
    "frontend/src/components/AdminGate.tsx",
    "frontend/src/components/AppLayout.tsx",
    "frontend/src/hooks/useAdmin.ts",
    "frontend/src/hooks/useIsAdmin.ts",
    "frontend/src/pages/AdminDashboardPage.tsx",
    "project_state.json"
  ]
}